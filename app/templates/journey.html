
{% extends 'base_authenticated.html' %}

{% block title %}Journey Builder - Comunica AI Studio{% endblock %}

{% block content %}
<!-- Page header -->
<div class="page-header">
    <h1 class="page-title">Journey Builder</h1>
    <p class="page-subtitle">Dissenya viatges personalitzats dels clients amb comunicacions automatitzades</p>
</div>
<!-- Info banner -->
<div class="info-banner">
    <div class="info-banner-content">
        <svg class="info-banner-icon" width="20" height="20" viewBox="0 0 24 24" fill="var(--primary-600)">
            <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
        </svg>
        <div>
            <h3 class="info-banner-title">Automatització intel·ligent</h3>
            <p class="info-banner-text">Crea seqüències de comunicacions que s'adapten automàticament segons el comportament dels teus clients.</p>
        </div>
    </div>
</div>
<!-- Create Journey -->
<div class="block">
    <div class="block-title">
        <div class="block-number">1</div>
        <h2>Crear nou journey</h2>
    </div>
    <div class="block-content">
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="journey_name" class="form-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display: inline; margin-right: var(--space-1);">
                        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                    </svg>
                    Nom del journey
                </label>
                <input 
                    type="text" 
                    id="journey_name" 
                    name="journey_name" 
                    class="form-input"
                    placeholder="Ex: Benvinguda nous clients"
                    required
                >
            </div>

            <div class="form-group">
                <label for="journey_description" class="form-label">Descripció</label>
                <textarea 
                    id="journey_description" 
                    name="journey_description" 
                    class="form-textarea"
                    rows="3"
                    placeholder="Descriu l'objectiu d'aquest journey i a qui va dirigit..."
                ></textarea>
            </div>

            <div class="form-group">
                <label for="trigger_type" class="form-label">Desencadenant</label>
                <select id="trigger_type" name="trigger_type" class="form-input">
                    <option value="signup">Registre nou usuari</option>
                    <option value="purchase">Compra realitzada</option>
                    <option value="abandon_cart">Carret abandonat</option>
                    <option value="inactivity">Inactivitat de l'usuari</option>
                    <option value="birthday">Aniversari del client</option>
                    <option value="custom">Personalitzat</option>
                </select>
            </div>

            <div class="form-group">
                <label for="target_cluster" class="form-label">Cluster objectiu (opcional)</label>
                <select id="target_cluster" name="target_cluster" class="form-input">
                    <option value="">Tots els clients</option>
                    <option value="cluster_1">Cluster 1 - Clients Premium</option>
                    <option value="cluster_2">Cluster 2 - Clients Ocasionals</option>
                    <option value="cluster_3">Cluster 3 - Clients Nous</option>
                </select>
                <div class="form-help">Selecciona un cluster específic per dirigir el journey</div>
            </div>
        </form>
    </div>
    <div class="block-actions">
        <button type="submit" form="journey-form" class="btn btn-primary btn-lg">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right: var(--space-1);">
                <path d="M12 5v14"/>
                <path d="M5 12h14"/>
            </svg>
            Crear Journey
        </button>
    </div>
</div>

<!-- Journey Steps Configuration -->
<div class="block">
    <div class="block-title">
        <div class="block-number success">2</div>
        <h2>Configurar passos del journey</h2>
    </div>
    <div class="block-content">
        <div style="display: grid; gap: var(--space-6);">
            <!-- Step 1 -->
            <div style="display: flex; align-items: center; gap: var(--space-4); padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius-lg); border: 1px solid var(--gray-200);">
                <div style="background: var(--primary-100); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary-700); font-weight: 700;">1</div>
                <div style="flex: 1;">
                    <h3 style="margin: 0; color: var(--gray-900); font-weight: 600;">Email de benvinguda</h3>
                    <p style="margin: 0; color: var(--gray-600); font-size: var(--font-size-sm);">Enviat immediatament després del desencadenant</p>
                </div>
                <div style="display: flex; gap: var(--space-2);">
                    <button class="btn btn-secondary">Editar</button>
                    <button class="btn btn-secondary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Arrow -->
            <div style="display: flex; justify-content: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="var(--gray-400)">
                    <path d="M12 5v14"/>
                    <path d="M19 12l-7 7-7-7"/>
                </svg>
            </div>

            <!-- Step 2 -->
            <div style="display: flex; align-items: center; gap: var(--space-4); padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius-lg); border: 1px solid var(--gray-200);">
                <div style="background: var(--success-100); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--success-700); font-weight: 700;">2</div>
                <div style="flex: 1;">
                    <h3 style="margin: 0; color: var(--gray-900); font-weight: 600;">Tips i consells</h3>
                    <p style="margin: 0; color: var(--gray-600); font-size: var(--font-size-sm);">Enviat 3 dies després del pas anterior</p>
                </div>
                <div style="display: flex; gap: var(--space-2);">
                    <button class="btn btn-secondary">Editar</button>
                    <button class="btn btn-secondary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Add Step -->
            <div style="display: flex; justify-content: center;">
                <button class="btn btn-primary" style="border: 2px dashed var(--primary-300); background: var(--primary-50);">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right: var(--space-1);">
                        <path d="M12 5v14"/>
                        <path d="M5 12h14"/>
                    </svg>
                    Afegir pas
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Active Journeys -->
<div class="block">
    <div class="block-title">
        <div class="block-number warning">3</div>
        <h2>Journeys actius</h2>
    </div>
    <div class="block-content">
        <div class="empty-state">
            <div class="empty-state-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="var(--gray-400)">
                    <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                </svg>
            </div>
            <h3 class="empty-state-title">Encara no tens cap journey actiu</h3>
            <p class="empty-state-text">Crea el teu primer journey per automatitzar les comunicacions amb els teus clients</p>
        </div>
    </div>
</div>

<script>
// Afegir l'id al formulari per poder-lo referenciar des del botó
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form[method="post"]');
    if (form && !form.hasAttribute('id')) {
        form.setAttribute('id', 'journey-form');
    }
});
</script>
{% endblock %}
